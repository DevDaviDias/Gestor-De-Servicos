<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clientes ‚Äî Gest√£o de Servi√ßos</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./src/css/style.css">
  <link rel="icon" href="/pwa-192x192.png">
</head>
<body>
  <header class="top-bar">
    <span class="app-name">üë¶ Clientes</span>
  </header>

  <main class="page-content">
    <div id="warrantyAlert" class="warranty-alert" style="display:none;">
      <span class="alert-text"></span>
    </div>

    <div class="search-container">
      <input type="text" id="searchInput" placeholder="üîç Buscar cliente..." class="search-input">
    </div>

    <div id="loadingClients" class="loading-container">
      <div class="spinner"></div>
      <p>Carregando clientes...</p>
    </div>

    <div id="clientsContainer" class="clients-grid" style="display:none;"></div>

    <div id="noClients" class="no-data" style="display:none;">
      <p>üì≠ Nenhum cliente cadastrado ainda.</p>
      <a href="index.html" class="btn-primary">‚ûï Cadastrar Primeiro Cliente</a>
    </div>
  </main>

  <!-- Edit Modal -->
  <div id="editModal" class="modal" style="display:none;">
    <div class="modal-content">
      <div class="modal-header">
        <h2>‚úèÔ∏è Editar Cliente</h2>
        <button class="modal-close">√ó</button>
      </div>
      <form id="editForm" class="form-card modal-form">
        <div class="form-group">
          <label>Nome do Cliente</label>
          <input type="text" id="editClientName" required>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Data do Servi√ßo</label>
            <input type="date" id="editServiceDate" required>
          </div>
          <div class="form-group">
            <label>Garantia (meses)</label>
            <input type="number" id="editWarranty" min="0" max="60" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Valor (R$)</label>
            <input type="number" id="editServiceValue" step="0.01" min="0" required>
          </div>
          <div class="form-group">
            <label>Pagamento</label>
            <select id="editPaymentStatus" required>
              <option value="pago">‚úÖ Pago</option>
              <option value="nao-pago">‚è≥ Pendente</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label>Observa√ß√µes</label>
          <textarea id="editObservations" rows="3"></textarea>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-secondary modal-cancel">Cancelar</button>
          <button type="submit" class="btn-primary">üíæ Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Modal -->
  <div id="deleteModal" class="modal" style="display:none;">
    <div class="modal-content modal-sm">
      <div class="modal-header">
        <h2>üóëÔ∏è Confirmar Exclus√£o</h2>
      </div>
      <p>Tem certeza que deseja excluir este cliente? Essa a√ß√£o n√£o pode ser desfeita.</p>
      <div class="modal-actions">
        <button class="btn-secondary" id="cancelDelete">Cancelar</button>
        <button class="btn-danger" id="confirmDelete">üóëÔ∏è Excluir</button>
      </div>
    </div>
  </div>

  <!-- Receipt Modal -->
  <div id="receiptModal" class="modal" style="display:none;">
    <div class="modal-content modal-receipt">
      <div class="modal-header">
        <h2>üìÑ Comprovante</h2>
        <button class="modal-close" id="closeReceipt">√ó</button>
      </div>

      <!-- Receipt Preview -->
      <div id="receiptPreview" class="receipt-wrapper">
        <div id="receiptContent" class="receipt">
          <!-- Header -->
          <div class="receipt-header">
            <div class="receipt-logo">üîß</div>
            <div class="receipt-brand">
              <div class="receipt-brand-name">Gest√£o de Servi√ßos</div>
              <div class="receipt-brand-sub">Comprovante de Servi√ßo</div>
            </div>
            <div class="receipt-badge" id="receiptBadge">PAGO</div>
          </div>

          <!-- Photo -->
          <div id="receiptPhotoWrap" class="receipt-photo-wrap">
            <img id="receiptPhoto" src="" alt="Foto do servi√ßo">
          </div>

          <!-- Client info -->
          <div class="receipt-section">
            <div class="receipt-row">
              <span class="receipt-label">Cliente</span>
              <span class="receipt-value" id="rClientName">‚Äî</span>
            </div>
            <div class="receipt-row">
              <span class="receipt-label">Data do Servi√ßo</span>
              <span class="receipt-value" id="rDate">‚Äî</span>
            </div>
            <div class="receipt-row">
              <span class="receipt-label">Garantia</span>
              <span class="receipt-value" id="rWarranty">‚Äî</span>
            </div>
            <div class="receipt-row">
              <span class="receipt-label">V√°lida at√©</span>
              <span class="receipt-value" id="rExpiry">‚Äî</span>
            </div>
          </div>

          <div class="receipt-divider">
            <span>Pe√ßas Utilizadas</span>
          </div>

          <div id="rParts" class="receipt-parts"></div>

          <div class="receipt-divider">
            <span>Observa√ß√µes</span>
          </div>

          <div id="rObs" class="receipt-obs">‚Äî</div>

          <!-- Total -->
          <div class="receipt-total">
            <span>Total</span>
            <span id="rTotal">R$ 0,00</span>
          </div>

          <!-- Footer -->
          <div class="receipt-footer">
            <div class="receipt-footer-line"></div>
            <p>Guarde este comprovante para refer√™ncia futura.</p>
            <p>Em caso de d√∫vidas, entre em contato conosco.</p>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="receipt-actions">
        <button id="shareWhatsAppBtn" class="btn-whatsapp-full">
          üì§ Compartilhar no WhatsApp
        </button>
        <button id="downloadReceiptBtn" class="btn-download">
          ‚¨áÔ∏è Baixar Imagem
        </button>
      </div>
    </div>
  </div>

  <nav class="bottom-nav">
    <a href="index.html" class="nav-item">
      <span class="nav-icon">üìù</span>
      <span class="nav-label">Cadastro</span>
    </a>
    <a href="clientes.html" class="nav-item active">
      <span class="nav-icon">üë•</span>
      <span class="nav-label">Clientes</span>
    </a>
    <a href="relatorios.html" class="nav-item">
      <span class="nav-icon">üìä</span>
      <span class="nav-label">Relat√≥rios</span>
    </a>
  </nav>

  <style>
    /* ‚îÄ‚îÄ Receipt Modal ‚îÄ‚îÄ */
    .modal-receipt {
      max-height: 92vh;
      overflow-y: auto;
      border-radius: 20px 20px 0 0;
    }

    .receipt-wrapper {
      background: #f0f0f0;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 16px;
    }

    .receipt {
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
      font-family: 'DM Sans', sans-serif;
      box-shadow: 0 4px 20px rgba(0,0,0,0.12);
    }

    .receipt-header {
      background: linear-gradient(135deg, #1d4ed8, #2563eb);
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      color: white;
    }

    .receipt-logo { font-size: 2rem; }

    .receipt-brand-name {
      font-family: 'Syne', sans-serif;
      font-weight: 800;
      font-size: 1rem;
      letter-spacing: -0.3px;
    }

    .receipt-brand-sub {
      font-size: 0.75rem;
      opacity: 0.8;
    }

    .receipt-badge {
      margin-left: auto;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.7rem;
      font-weight: 800;
      letter-spacing: 1px;
      background: rgba(255,255,255,0.2);
      border: 1.5px solid rgba(255,255,255,0.4);
    }
    .receipt-badge.pending {
      background: rgba(217,119,6,0.3);
      border-color: rgba(217,119,6,0.6);
    }

    .receipt-photo-wrap {
      width: 100%;
      height: 180px;
      overflow: hidden;
      display: none;
    }
    .receipt-photo-wrap.has-photo { display: block; }
    .receipt-photo-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .receipt-section { padding: 16px 20px; }

    .receipt-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px dashed #f0f0f0;
      font-size: 0.88rem;
    }
    .receipt-row:last-child { border-bottom: none; }

    .receipt-label { color: #9095a1; }
    .receipt-value { font-weight: 600; color: #0f1117; text-align: right; max-width: 60%; }

    .receipt-divider {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 0 20px;
      margin: 4px 0;
    }
    .receipt-divider::before,
    .receipt-divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #e8eaee;
    }
    .receipt-divider span {
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #9095a1;
      white-space: nowrap;
    }

    .receipt-parts {
      padding: 10px 20px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .receipt-part-row {
      display: flex;
      justify-content: space-between;
      font-size: 0.85rem;
    }
    .receipt-part-row span:last-child { font-weight: 600; color: #2563eb; }

    .receipt-obs {
      padding: 10px 20px 16px;
      font-size: 0.85rem;
      color: #4a4e5a;
      line-height: 1.5;
    }

    .receipt-total {
      margin: 0 20px 20px;
      background: #0f1117;
      color: white;
      border-radius: 10px;
      padding: 14px 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-family: 'Syne', sans-serif;
      font-weight: 800;
      font-size: 1.1rem;
    }

    .receipt-footer {
      padding: 16px 20px;
      background: #f9fafb;
      text-align: center;
      border-top: 1px dashed #e8eaee;
    }

    .receipt-footer-line {
      display: flex;
      gap: 4px;
      justify-content: center;
      margin-bottom: 10px;
    }
    .receipt-footer-line::before {
      content: '‚ú¶ ‚ú¶ ‚ú¶';
      color: #2563eb;
      font-size: 0.7rem;
      letter-spacing: 4px;
    }

    .receipt-footer p {
      font-size: 0.72rem;
      color: #9095a1;
      line-height: 1.6;
    }

    /* ‚îÄ‚îÄ Receipt Buttons ‚îÄ‚îÄ */
    .receipt-actions {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .btn-whatsapp-full {
      width: 100%;
      padding: 14px;
      background: #25d366;
      color: white;
      border: none;
      border-radius: 12px;
      font-family: 'Syne', sans-serif;
      font-size: 0.95rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 14px rgba(37,211,102,0.35);
    }
    .btn-whatsapp-full:hover { background: #1ea952; transform: translateY(-1px); }

    .btn-download {
      width: 100%;
      padding: 12px;
      background: #f5f6f8;
      color: #4a4e5a;
      border: 1.5px solid #e8eaee;
      border-radius: 12px;
      font-family: 'DM Sans', sans-serif;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-download:hover { background: #e8eaee; }
  </style>

  <script type="module" src="./src/js/main.js"></script>
</body>
</html>
